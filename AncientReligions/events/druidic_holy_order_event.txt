#######################################
#
# The Sons of Gwydion
#
# Event ID ancrel.110 - ancrel.149 reserved
#
#######################################

# Written by Superskierpat

namespace = ancrel

# The Sons of Gwydion Founded (Celtic King)
narrative_event = {
	id = ancrel.110
	title = EVTNAMEancrel.110
	desc = EVTDESCancrel.110
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	hide_from = yes
	
	option = {
		name = EVTOPTAancrel.110
		hidden_tooltip = {
			any_playable_ruler = {
				limit = {
					ai = no
					religion = druidic
				}
				narrative_event = { id = ancrel.111 }
			}
		}
	}
}

# The sons of Gwydion Founded (Druidic)
narrative_event = {
	id = ancrel.111
	title = EVTNAMEancrel.110
	desc = EVTDESCancrel.111
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.111
		custom_tooltip = gwydion_organized
	}
}

# Sons of Gwydion Chief gets Wolf trait
character_event = {
	id = ancrel.115
	hide_window = yes
	
	trigger = {
		has_landed_title = d_gwydion
		NOT = { trait = wolf }
	}
	
	immediate = {
		add_trait = wolf
	}
	
	option = {
		name = OK
	}
}

# Son has served a few years
character_event = {
	id = ancrel.118
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = serving_gwydion
		clr_character_flag = wants_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son wants to join the Sons of Gwydion (Son)
character_event = {
	id = ancrel.119
	hide_window = yes
	
	ai = yes
	min_age = 16
	max_age = 40
	only_men = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Old Gods"
		is_landed = no
		in_command = no
		has_global_flag = gwydion_founded
		religion = druidic
		NOT = { 
			trait = varangian 
			has_character_flag = wants_gwydion
		}
		father = {
			is_alive = yes
			religion = celtic
			is_ruler = yes
			is_liege_of = ROOT
			prisoner = no
			NOT = { trait = incapable }
			ROOT = { host = { character = PREVPREV } }
		}
	}
	
	mean_time_to_happen = {
		months = 240
		
		modifier = {
			factor = 0.5
			trait = ambitious
		}
		modifier = {
			factor = 0.5
			trait = brave
		}
		modifier = {
			factor = 0.75
			OR = {
				trait = head1
				trait = head2
				trait = head3
				trait = head4
				trait = head5
			}
		}
		modifier = {
			factor = 0.75
			trait = proud
		}
		modifier = {
			factor = 0.75
			trait = impaler
		}
		modifier = {
			factor = 1.5
			trait = slothful
		}
		modifier = {
			factor = 1.5
			trait = content
		}
		modifier = {
			factor = 1.5
			is_primary_heir = yes
		}
		modifier = {
			factor = 2.0
			trait = craven
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.120 } }
		set_character_flag = wants_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son wants to join the sons of Gwydion (Father)
character_event = {
	id = ancrel.120
	desc = EVTDESCancrel.120
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.120
		FROM = {
			opinion = {
				modifier = opinion_very_disappointed
				years = 1
				who = ROOT
			}
		}
		prestige = -100
	}
	option = {
		name = EVTOPTBancrel.120
		d_gwydion = {
			holder_scope = {
				FROM = {
					move_character = PREV
				}
			}
		}
		hidden_tooltip = {
			FROM = { 
				character_event = { id = ancrel.118 days = 1460 }
			}
		}
		prestige = 100
	}
}

# Son returns scarred but seasoned (Son)
character_event = {
	id = ancrel.124
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
		NOT = { trait = scarred }
	}
	
	mean_time_to_happen = {
		months = 160
		
		modifier = {
			factor = 0.75
			trait = brave
		}
		modifier = {
			factor = 1.25
			trait = craven
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.125 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns scarred but seasoned
character_event = {
	id = ancrel.125
	desc = EVTDESCancrel.125
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.125
		FROM = {
			move_character = ROOT
			add_trait = scarred
			add_trait = wolf
			change_martial = 4
		}
	}
}

# Son returns maimed (Son)
character_event = {
	id = ancrel.128
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
		NOT = {
			trait = maimed
		}
	}
	
	mean_time_to_happen = {
		months = 250
	}
	
	immediate = {
		add_trait = maimed
		father = { character_event = { id = ancrel.129 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns maimed
character_event = {
	id = ancrel.129
	desc = EVTDESCancrel.129
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.129
		FROM = {
			move_character = ROOT
			tooltip = { add_trait = maimed }
			add_trait = wolf
		}
	}
}

# Son returns as excellent strategist (Son)
character_event = {
	id = ancrel.130
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_varangian
		NOT = { trait = brilliant_strategist }
		OR = {
			trait = misguided_warrior
			trait = tough_soldier
			trait = skilled_tactician
		}
	}
	
	mean_time_to_happen = {
		months = 160
		
		modifier = {
			factor = 0.5
			trait = genius
		}
		modifier = {
			factor = 0.75
			trait = diligent
		}
		modifier = {
			factor = 0.75
			trait = quick
		}
		modifier = {
			factor = 1.5
			trait = slow
		}
		modifier = {
			factor = 1.5
			trait = imbecile
		}
	}

	immediate = {
		father = { character_event = { id = ancrel.131 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns as excellent strategist
character_event = {
	id = ancrel.131
	desc = EVTDESCancrel.131
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.131
		if = {
			limit = {
				FROM = {
					trait = skilled_tactician
				}
			}
			FROM = {
				hidden_tooltip = { remove_trait = skilled_tactician }
				add_trait = brilliant_strategist
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						trait = misguided_warrior
						trait = tough_soldier
					}	
				}
			}
			FROM = {
				hidden_tooltip = { 
					remove_trait = misguided_warrior
					remove_trait = tough_soldier
				}
				add_trait = skilled_tactician
			}
		}
		FROM = {
			change_martial = 2
			add_trait = wolf
			move_character = ROOT
		}
	}
}

# Son returns with PTSD (Son)
character_event = {
	id = ancrel.132
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
		NOT = { trait = depressed }
	}
	
	mean_time_to_happen = {
		months = 180
		
		modifier = {
			factor = 0.75
			trait = kind
		}
		modifier = {
			factor = 0.75
			trait = poet
		}
		modifier = {
			factor = 0.75
			trait = just
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.133 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns with PTSD
character_event = {
	id = ancrel.133
	desc = EVTDESCancrel.133
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.133
		FROM = {
			move_character = ROOT
			add_trait = stressed
			add_trait = depressed
			add_trait = wolf
		}
	}
}

# Son returns home with wife (Son)
character_event = {
	id = ancrel.134
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_varangian
		is_married = no
	}
	
	mean_time_to_happen = {
		months = 180
		
		modifier = {
			factor = 0.75
			trait = lustful
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.135 } }
		clr_character_flag = serving_wolf
	}
	
	option = {
		name = OK
	}
}

# Son returns home with wife
character_event = {
	id = ancrel.135
	desc = EVTDESCancrel.135
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.135
		create_character = {
			random_traits = yes
			dynasty = NONE
			female = yes
			age = 26
			religion = druidic
			culture = FROM
		}
		new_character = {
			add_spouse = FROM
		}
		FROM = { 
			add_trait = wolf 
			move_character = ROOT
		}
	}
}

# Son returns home as a zealot (Son)
character_event = {
	id = ancrel.136
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
		NOT = { trait = zealous }
	}
	
	mean_time_to_happen = {
		months = 160
		
		modifier = {
			factor = 2.0
			trait = cynical
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.137 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns home as a Christian zealot
character_event = {
	id = ancrel.137
	desc = EVTDESCancrel.137
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.137
		FROM = {
			move_character = ROOT
			add_trait = zealous
			add_trait = wolf
		}
	}
}

# Son returns home as a seasoned warrior (Son)
character_event = {
	id = ancrel.138
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
	}
	
	mean_time_to_happen = {
		months = 120
		
		modifier = {
			factor = 0.75
			trait = brave
		}
		modifier = {
			factor = 0.75
			trait = strong
		}
		modifier = {
			factor = 0.75
			trait = quick
		}
		modifier = {
			factor = 0.75
			trait = genius
		}
		modifier = {
			factor = 1.5
			trait = slothful
		}
		modifier = {
			factor = 1.5
			trait = slow
		}
		modifier = {
			factor = 1.5
			trait = imbecile
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.139 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns home as a seasoned warrior
character_event = {
	id = ancrel.139
	desc = EVTDESCancrel.139
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.139
		FROM = {
			move_character = ROOT
			add_trait = brave
			add_trait = wolf
			change_martial = 2
		}
	}
}

# Son dies in battle (Son)
character_event = {
	id = ancrel.140
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
	}
	
	mean_time_to_happen = {
		months = 200
		
		modifier = {
			factor = 0.75
			trait = brave
		}
		modifier = {
			factor = 0.75
			trait = wroth
		}
		modifier = {
			factor = 0.75
			trait = head1
		}
		modifier = {
			factor = 0.75
			trait = head2
		}
				modifier = {
			factor = 0.75
			trait = head3
		}
		modifier = {
			factor = 0.75
			trait = head4
		}
		modifier = {
			factor = 0.75
			trait = head5
		}
		modifier = {
			factor = 1.25
			trait = craven
		}
		modifier = {
			factor = 0.75
			trait = drunkard
		}
		modifier = {
			factor = 0.75
			trait = has_tuberculosis
		}
		modifier = {
			factor = 0.75
			trait = has_typhoid_fever
		}
		modifier = {
			factor = 0.75
			trait = has_typhus
		}
		modifier = {
			factor = 0.75
			trait = has_bubonic_plague
		}
		modifier = {
			factor = 0.75
			trait = has_measles
		}		
		modifier = {
			factor = 0.75
			trait = has_small_pox
		}
		modifier = {
			factor = 0.75
			trait = wounded
		}
		modifier = {
			factor = 0.5
			trait = infirm
		}
		modifier = {
			factor = 0.5
			trait = incapable
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.141 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son dies in battle
character_event = {
	id = ancrel.141
	desc = EVTDESCancrel.141
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.141
		FROM = { death = { death_reason = death_battle } }
	}
}

# Son returns with loot (Son)
character_event = {
	id = ancrel.142
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		has_character_flag = serving_gwydion
	}
	
	mean_time_to_happen = {
		months = 160
		
		modifier = {
			factor = 0.75
			trait = greedy
		}
		modifier = {
			factor = 0.75
			stewardship = 10
		}
	}
	
	immediate = {
		father = { character_event = { id = ancrel.143 } }
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}

# Son returns with loot
character_event = {
	id = ancrel.143
	desc = EVTDESCancrel.143
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAancrel.143
		FROM = {
			move_character = ROOT
			add_trait = wolf
		}
		wealth = 300
	}
}

# Father dies, Player Son is heir
character_event = {
	id = ancrel.144
	desc = EVTDESCancrel.144
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_war
	
	trigger = {
		has_dlc = "The Old Gods"
		ai = no
		OR = {
			has_character_flag = wants_gwydion
			has_character_flag = serving_gwydion
		}
		father = { is_alive = no }
	}
	
	immediate = {
		clr_character_flag = wants_gwydion
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = EVTOPTAancrel.144
		add_trait = wolf
		prestige = 200
		wealth = 200
	}
}

# Father dies, Son gets Varangian trait
character_event = {
	id = ancrel.145
	hide_window = yes
	
	trigger = {
		has_dlc = "The Old Gods"
		ai = yes
		OR = {
			has_character_flag = wants_gwydion
			has_character_flag = serving_gwydion
		}
		father = { is_alive = no }
	}
	
	immediate = {
		add_trait = wolf
		clr_character_flag = wants_gwydion
		clr_character_flag = serving_gwydion
	}
	
	option = {
		name = OK
	}
}